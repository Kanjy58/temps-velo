L.Permalink={getMapLocation:function(zoom,center,layers){'use strict';zoom=(zoom||zoom===0)?zoom:18;center=(center)?center:[52.26869,-113.81034];layers=(layers)?layers:[];if(window.location.hash!==''){var hash=window.location.hash.replace('#','');var parts=hash.split(',');if(parts.length>=3){center={lat:parseFloat(parts[0]),lng:parseFloat(parts[1])};zoom=parseInt(parts[2].slice(0,-1),10);if((parts.length>=4)&&(parts[3]!=="")){layers=parts.slice(3);}}}
return{zoom:zoom,center:center,layers:new Set(layers)};},setup:function(map,layers,updateLayers){'use strict';var shouldUpdate=true;var currentLayers=layers;updateLayers(currentLayers);var updatePermalink=function(){if(!shouldUpdate){shouldUpdate=true;return;}
var center=map.getCenter();var hash='#'+
Math.round(center.lat*100000)/100000+','+
Math.round(center.lng*100000)/100000+','+
map.getZoom()+'z,'+
Array.from(currentLayers).sort().join(',')
var state={zoom:map.getZoom(),center:center,layers:currentLayers};window.history.pushState(state,'map',hash);};var overlayAdd=function(e){currentLayers.add(e.name);updatePermalink();};var overlayRemove=function(e){currentLayers.delete(e.name);updatePermalink();};map.on('moveend',updatePermalink);map.on('overlayadd',overlayAdd);map.on('overlayremove',overlayRemove);window.addEventListener('popstate',function(event){if(event.state===null){return;}
map.setView(event.state.center,event.state.zoom);currentLayers=event.state.layers;updateLayers(currentLayers);shouldUpdate=false;});}};